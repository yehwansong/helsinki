<!DOCTYPE html>
<html>
<head> f
    <meta charset="UTF-8">
    <title></title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
<script src="delaunator.min.js"></script>
<script src="three.min.js"></script>
<script src="OrbitControls.js"></script>
<script src="locations.js"></script>
<script src="names.js"></script>
<script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
<style type="text/css">

    @font-face {
      font-family: CircularStd;
      src: url(font/ABCSynt-Regular.3c2e004.woff);
    }
    *{
      font-family: "CircularStd", Times, serif;
    }
    .tags{
        position: absolute;
        transform: translate(-50%, -50%);
        /*width: 12.5vh;*/
        /*height: 12.5vh;*/
    }
    .circle{
        width: 100%; 
        height: 100%;
        border: 0.1vh solid #ffffff;
        position: absolute;
        left: 0;
        top: 0;
        box-shadow: 0vh 0vh 1vh #000000;
        pointer-events: none;
        /*display: none;*/
    }
    .tags_wrapper{
        transition: 0.5s
    }
    .stopped .tags_wrapper{
        opacity: 0
    }
    .tags_mouse{
        pointer-events: none;
        background-color: white;
        border: 1px solid black;
        transform:none;
        opacity: 0;
        transition: opacity 0.5s;
    }
    .zoomout{
        position: absolute;
        left: 1vh;
        top: 1vh;
        height: 45vh;
        z-index: 10000000;
        background-image: url(img/map.png);
        background-repeat: no-repeat;
        background-size: 100% 100%;
        background-color: #cfd6d8;
        border: 2px solid white;
        box-shadow: 0vh 0vh 0.1vh 0.25vh #000000
    }
    .name {
        /*transform: translateY(-100%);*/
        background: black;
        color: white;
        padding: 0.3vh;
        box-sizing: border-box;
        white-space: nowrap;
        font-size: 1.75vh;
        line-height: 1;
    }
    .dot{
        width: 0.5vh;
        height: 0.5vh;
        background-color: #6288fa;
        border:1px solid red;
        position: absolute;
        border-radius: 50%
    }
    .selected_dot{
        background: red
    }
    .tags_wrapper{
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }
    *{
        margin: 0;
        overflow: hidden;
    }
    html,body{
        overflow: hidden;
        width: 100%;
        height: 100%;
        background: black;
    }
    .name{
        position: relative;
    }
    .subtitle{
        position: absolute;
        z-index: 1000000;
        bottom: 2vh;
        left: 50%;
        transform: translateX(-50%);
        background: black;
        color: white;
        font-style: italic;
        font-size: 2vh;
        padding-left: 0.5vh;
        padding-right: 0.5vh;
        line-height: 1.2;
        border-radius: 0.1vh;
    }
    .black{
        width: 100vw;
        height: 100vh;
        position: absolute;
        left: 0;
        top: 0;
        z-index: 100000000000;
    background: black;
    }
</style>
</head>
<body>
<script type="text/javascript">
var isMobile = false;
// device detection
if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) 
    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))) { 
    isMobile = true;
}
    var points_pre = []
    var points = []
    var markers = [];
    var name_array = []
    var svgData
    var polygon_Array = []
    var windowWidth = window.innerWidth
    var windowHeight = window.innerHeight
    var counter = 0
    var ani_counter = -5000
    let polygons_origin
    let polygons
    var height = 20
    var sphere_Array = []
    var hovered = false
    var stoped = false


    function map(value, start1, stop1, start2, stop2) {
        var range1 = (value - start1) / (stop1 - start1);
        var range2 = range1 * (stop2 - start2) + start2;
        return range2;
    } 
    function calculateDistance(dot1, dot2) {
        const [x1, y1] = dot1;
        const [x2, y2] = dot2;
        const dx = x2 - x1;
        const dy = y2 - y1;
        return Math.sqrt(dx * dx + dy * dy);
    }


</script>
<script>
    const scene = new THREE.Scene();

    var map
    var map_fake
    var plane
    var pos_x = 0 
    var pos_y = 0




    const renderer = new THREE.WebGLRenderer( { alpha: true } );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( 0x000000, 0 );
    const views = [
        {
            left: 0,
            bottom: 0,
            width: 1,
            height: 1,
            fov: 15,
            background: '#ffffff'
        }
    ];
let camera
// var camera_pivot = new THREE.Group()
for ( let ii = 0; ii < views.length; ++ ii ) {
    const view = views[ ii ];
    camera = new THREE.PerspectiveCamera( view.fov, window.innerWidth / window.innerHeight, 1, 50000 );

    camera.updateProjectionMatrix();
    camera.position.set(0 , -100, -100)
    view.camera = camera;
}

    document.body.appendChild( renderer.domElement );


function remapFloat(v_, min0_, max0_, min1_, max1_) { return min1_ + (v_ - min0_) / (max0_ - min0_) * (max1_ - min1_); }

</script>
<script type="module">
    import * as THREE from './js/three.module.min.js';
    import  { OrbitControls }  from './js/OrbitControls.js';

function calculateDistance(point1, point2) {
  const [x1, y1] = point1;
  const [x2, y2] = point2;
  return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
}
function degreesToRadians(degrees) {
  var radians = degrees * (Math.PI / 180);
  return radians;
}
function orderPointsByDistance(array) {
    if (array.length <= 1) {
    return array;
    }

    const orderedPoints = [array[0]];
    let remainingPoints = array.slice(1);

    while (remainingPoints.length > 0) {
    const lastPoint = orderedPoints[orderedPoints.length - 1];
    let closestDistance = Infinity;
    let closestPointIndex = -1;

    for (let i = 0; i < remainingPoints.length; i++) {
      const point = remainingPoints[i];
      const distance = calculateDistance(lastPoint, point);
      if (Math.abs(distance - 10) < Math.abs(closestDistance - 10) && distance >= 20) {
        closestDistance = distance;
        closestPointIndex = i;
      }
    }

    if (closestPointIndex === -1) {
      // No point found that satisfies both conditions, break the loop
      break;
    }

    const closestPoint = remainingPoints[closestPointIndex];
    orderedPoints.push(closestPoint);
    remainingPoints.splice(closestPointIndex, 1);
    }

    return orderedPoints;
}


function reverseArray(arr) {
  let start = 0;
  let end = arr.length - 1;

  while (start < end) {
    // Swap elements
    const temp = arr[start];
    arr[start] = arr[end];
    arr[end] = temp;
    start++;
    end--;
  }

  return arr;
}
var objGroup, objGroup_clone
make_sphere()
function make_sphere(){
    objGroup = new THREE.Group()
    scene.add(objGroup)
    for (var i = db.features.length - 1; i >= 0; i--) {
        var group = new THREE.Group()
        objGroup.add(group)
    }
        points = Array(db.features.length)
        if(isMobile){points = Array(Math.floor(db.features.length/3))}
        var min_0 = 24.85
        var max_0 = 25.12
        var min_1 = 60.13
        var max_1 = 60.26

        var mapsize_x = 0.95924*2500
        var mapsize_y = 2500

        $('.zoomout').css({'width':(0.95924)*$('.zoomout').outerHeight()+'px'})
        if((0.95924)*$('.zoomout').outerHeight()>window.innerWidth/2){
            $('.zoomout').css({'width':window.innerWidth/2+'px'})
            $('.zoomout').css({'height':window.innerWidth/2/(0.95924)+'px'})
        }
        for (var k = points.length - 1; k >= 0; k--) {
            points[k]=Array(4)
            points[k][0] = map(db.features[k].properties.lon, min_0, max_0, -1*mapsize_x/2, mapsize_x/2)
            points[k][1] = map(db.features[k].properties.lat, min_1, max_1, -1*mapsize_y/2, mapsize_y/2)
            points[k][4] = db.features[k].properties.img
            if(k==0){

        points = orderPointsByDistance(points)
        // points = reverseArray(points);
                for (var l = points.length - 1; l >= 0; l--) {
                    const geometry = new THREE.SphereGeometry( 25, 32, 32 );
                        if(db.features[l]){
                            var img = points[l][4]
                        }else{
                            var img = ''
                        }
                    let texture = new THREE.TextureLoader().load( 'img/img_'+img+'.jpg' )
                    const m1 = new THREE.MeshBasicMaterial( { 
                                        map: texture,
                                        side: THREE.DoubleSide } );
                    const sphere = new THREE.Mesh( geometry, m1 );
                    var sphere_group = new THREE.Group()
                    sphere_group.add(sphere)
                    sphere_Array.push(sphere_group)
                    objGroup.children[l].add(sphere_group)
                    var name = ''
                            for (var i = names.length - 1; i >= 0; i--) {
                                if(names[i].object_ID == points[l][4]){
                                    name = names[i].title.split("'")[names[i].title.split("'").length-2].replace(/ /g, '%');
                                }
                            }
                    sphere.name = l +'_'+name+'_'+db.features[l].properties.lon.toString().replace(/\./g, '%')+'_'+db.features[l].properties.lat.toString().replace(/\./g, '%')+'_'+points[l][4]
                    sphere.position.z = -50


                    // const geometry_c = new THREE.BoxGeometry( 1, 1, 1000 ); 
                    const geometry_c = new THREE.CylinderGeometry( 0.25, 0.25, 1000, 6 );
                    let texture4 = new THREE.TextureLoader().load( 'img/dash.png' )
                    texture4.wrapS = THREE.RepeatWrapping;
                    texture4.wrapT = THREE.RepeatWrapping;
                    texture4.repeat.set(1, 5);
                    // var material_c = new THREE.MeshBasicMaterial({ map:texture4 , transparent: true,})
                    var material_c = new THREE.MeshBasicMaterial({ color:0x000000})
                    const cube = new THREE.Mesh( geometry_c, material_c ); 
                    var cubeGroup = new THREE.Group()
                    cube.rotation.x = degToRad(90)
                    cube.position.z = 500
                    objGroup.children[l].add( cubeGroup );
                    cubeGroup.add(cube)



                    const geometry5 = new THREE.SphereGeometry( 5, 32, 32 );
                    const m5 = new THREE.MeshBasicMaterial( { color:0x000000} );
                    const sm_sphere = new THREE.Mesh( geometry5, m5 );
                    objGroup.children[l].add( sm_sphere );



                    points[l][2] = 40*l
                    objGroup.children[l].position.set(points[l][0],points[l][1],points[l][2])
                    $('.zoomout').append('<div class="dot dot_'+l+'"></div>')
                    $('.dot_'+l).css({'left':((points[l][0]+mapsize_x/2)/mapsize_x)*100+'%'})
                    $('.dot_'+l).css({'top':((points[l][1]+mapsize_y/2)/mapsize_y)*100+'%'})
                }
            }
        }

                    const geometry = new THREE.PlaneGeometry( mapsize_x, mapsize_y );
                                        let texture2 = new THREE.TextureLoader().load( 'img/map.png')
                    texture2.wrapS = THREE.RepeatWrapping;
                    texture2.wrapT = THREE.RepeatWrapping;
                    texture2.repeat.set(1, 1);
                    let m2 = new THREE.MeshBasicMaterial( {
                        map: texture2,
                        transparent: true,
                        side: THREE.DoubleSide
                    } );
                    const geometry2 = new THREE.PlaneGeometry( mapsize_x*2.4, mapsize_y );

                    map = new THREE.Mesh( geometry, m2 );
                    map.position.z = 0
                    map.rotation.x = degToRad(180)
                    scene.add( map );
                    if(!isMobile){
                                        let texture3 = new THREE.TextureLoader().load( 'img/map_big.png' )
                                        texture3.wrapS = THREE.RepeatWrapping;
                                        texture3.wrapT = THREE.RepeatWrapping;
                                        texture3.repeat.set(1, 1);
                                        let m3 = new THREE.MeshBasicMaterial( {
                                            map: texture3,
                                            transparent: true,
                                            side: THREE.DoubleSide
                                        } );
                                        map_fake = new THREE.Mesh( geometry2, m3 );
                                        map_fake.position.z = 0
                                        map_fake.rotation.x = degToRad(180)
                                        scene.add( map_fake );
                                    }
}
var dots = points
let currentDotIndex = 0;
let c_currentDotIndex = 0;
let currentDot = new THREE.Vector3(dots[currentDotIndex][0], dots[currentDotIndex][1], 0);
let nextDot = new THREE.Vector3(dots[currentDotIndex + 1][0], dots[currentDotIndex + 1][1], 0);
let c_currentDot = new THREE.Vector3(dots[currentDotIndex][0], dots[currentDotIndex][1], 0);
let c_nextDot = new THREE.Vector3(dots[currentDotIndex + 1][0], dots[currentDotIndex + 1][1], 0);
let t = 0.75;
let c_t = 0;
const controls = new OrbitControls( camera, renderer.domElement );
const raycaster = new THREE.Raycaster();
const pointer = new THREE.Vector2();
var intersects
var clicked = false
var click_animating = false
var click_ani_counter = 0
var ani_counter_start = false
    const worldPosition = new THREE.Vector3();
                var x1
                var x2
                var y1
                var y2
                var z1
                var z2
                var selected

scene.fog = new THREE.Fog( 0xffffff, 2500, 6500 );
function toScreenPosition(obj, camera)
{
    if(obj){
        var vector = new THREE.Vector3();
    
        var widthHalf = 0.5*renderer.context.canvas.width;
        var heightHalf = 0.5*renderer.context.canvas.height;
    
        obj.updateMatrixWorld();
        vector.setFromMatrixPosition(obj.matrixWorld);
        vector.project(camera);
    
        vector.x = ( vector.x * widthHalf ) + widthHalf;
        vector.y = - ( vector.y * heightHalf ) + heightHalf;
    
        return { 
            x: vector.x, 
            y: vector.y
        };
    }else{
        return { 
            x: 0,
            y: 0
        };
    }

};
var target = new THREE.Vector3(); // create once an reuse it

$(document).ready(function(){
    $('.stop_btn').click(function(){
        if(!stoped){
            stoped = true
            $('body').addClass('stopped')
            $('.stop_btn').html('PLAY')
        }else{
            stoped = false
            $('.stopped').removeClass('stopped')
            $('.stop_btn').html('STOP')
        }
    })
    var $element = $('.tags_mouse');
    $(document).on('mousemove', function(event) {
      // Update the position of the element based on the cursor coordinates
      var xPos = event.clientX;
      var yPos = event.clientY;
      $element.css({ left: xPos, top: yPos });
    });

    setTimeout(function(){
        ani_counter_start =  true
        $('.black').fadeOut(1000) 
        $('body').css({'background-color':'#e7e7e7'})
    },2000)
    $('canvas').click(function(){
        if(intersects.length>0 &&clicked== false){
            clicked = true
            click_ani_counter = 0
        }
    })
  // Event listeners for arrow key presses
  document.addEventListener('keydown', onKeyDown);
  document.addEventListener('keyup', onKeyUp);

  })







var moveLeft = false;
var moveRight = false;
var moveUp = false;
var moveDown = false;

function onKeyDown(event) {
  switch (event.keyCode) {
    case 37: // Left arrow key
      moveLeft = true;
      break;
    case 39: // Right arrow key
      moveRight = true;
      break;
    case 38: // Up arrow key
      moveUp = true;
      break;
    case 40: // Down arrow key
      moveDown = true;
      break;
  }
}

function onKeyUp(event) {
  switch (event.keyCode) {
    case 37: // Left arrow key
      moveLeft = false;
      break;
    case 39: // Right arrow key
      moveRight = false;
      break;
    case 38: // Up arrow key
      moveUp = false;
      break;
    case 40: // Down arrow key
      moveDown = false;
      break;
  }
}

window.addEventListener( 'pointermove', onPointerMove );
function onPointerMove( event ) {
    pointer.x = ( event.clientX / window.innerWidth ) * 2 - 1;
    pointer.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
}

function animate() {
if(clicked){

}else{

}

for (var i = points.length - 1; i >= 0; i--) {
            if(((points[i][2]-1*ani_counter) - (Math.abs((ani_counter/3)%2000-1000)-1500))/1000<0){
                objGroup.children[i].children[1].scale.set(1,1,Math.abs(((points[i][2]-1*ani_counter) - (Math.abs((ani_counter/3)%2000-1000)-1500))/1000))
                objGroup.children[i].children[2].position.z = Math.abs(((points[i][2]-1*ani_counter) - (Math.abs((ani_counter/3)%2000-1000)-1500))/1000)*1000
            }else{
                objGroup.children[i].children[1].scale.set(0,0,0)
            }
    if(points[i][2]-1*ani_counter<-5000){
        points[i][2] = points[i][2]+objGroup.children.length*20
        objGroup.children[i].position.set(points[i][0],points[i][1],points[i][2])
    }
}
// if(ani_counter<5000){
    // ani_counter = ani_counter+2
// }
if(ani_counter_start && !stoped){
    if(ani_counter>-4000){
        $('.subtitle_1').hide()
        $('.subtitle_2').show()
        $('.subtitle_3').hide()
    }else{
        $('.subtitle_1').show()
        $('.subtitle_2').hide()
        $('.subtitle_3').hide()
    }
    if(ani_counter<0){
        ani_counter = ani_counter+10
        if(!isMobile){
            map_fake.visible =true
            map.visible =false
            map_fake.position.z =-500-ani_counter
        }
    }else{
        ani_counter = ani_counter+10
        if(!isMobile){
            map_fake.visible =false
        }
        map.visible =true
        map.position.z =Math.abs((ani_counter/3)%2000-1000)-1500
        if(ani_counter>1000){
            $('.subtitle').fadeIn(300)
        $('.subtitle_1').hide()
        $('.subtitle_2').hide()
            $('.subtitle_3').show()
        }
    }
}
// console.log(ani_counter)

for (let ii = 0; ii < views.length; ii++) {
    const view = views[ii];
    const camera = view.camera;


    const left = Math.floor(windowWidth * view.left);
    const bottom = Math.floor(windowHeight * view.bottom);
    const width = Math.floor(windowWidth * view.width);
    const height = Math.floor(windowHeight * view.height);
    if (moveLeft) {
        pos_x = pos_x+ 1;
    }
    if (moveRight) {
        pos_x = pos_x- 1;
    }
    if (moveUp) {
        pos_y = pos_y+ 1;
    }
    if (moveDown) {
        pos_y = pos_y- 1;
    }
    camera.rotation.z = degToRad(ani_counter/100)
    if(!clicked){
        objGroup.position.z = -1*ani_counter
    }
    objGroup.position.x  = pos_x
    objGroup.position.y  = pos_y
    map.position.x  = pos_x
    map.position.y  = pos_y
    if(!isMobile){
        map_fake.position.x  = pos_x
        map_fake.position.y  = pos_y
    }
    var value = Math.floor(Math.floor(ani_counter/40/2)*2)-50
    
    if (ii == 0) {
        raycaster.setFromCamera( pointer, camera );
        intersects = raycaster.intersectObjects( sphere_Array );
        for (var i = sphere_Array.length - 1; i >= 0; i--) {
            hovered = false
            sphere_Array[i].children[0].material.color.set( 0xffffff );
            $('.selected_dot').removeClass('selected_dot')
        }
        if ( intersects.length>0 ) {
            hovered = true
            if(ani_counter>1000){
                        intersects[ 0 ].object.material.color.set( 0x000000 );
                        $('.dot_'+intersects[ 0 ].object.name.split('_')[0]).addClass('selected_dot')
                        $('.tags_mouse').html(intersects[ 0 ].object.name.split('_')[1].replace(/%/g, ' '))
                        $('.tags_mouse').css({'opacity':1})
                    }
        }else{
            $('.tags_mouse').css({'opacity':0})
        }
        if(objGroup.children[(value)%(objGroup.children.length-5)]){
            if(objGroup.children[(value)%(objGroup.children.length-5)].children[0]){
                        $('.tags_0').css({'left':toScreenPosition(objGroup.children[(value)%(objGroup.children.length-5)].children[0], camera).x+'px'})
                        $('.tags_0').css({'top' :toScreenPosition(objGroup.children[(value)%(objGroup.children.length-5)].children[0], camera).y+'px'})
                        console.log(objGroup.children[(value)%(objGroup.children.length-5)].children[0])
                        $('.tags_0').find('.name').html(objGroup.children[(value)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1].replace(/%/g, ' '));}
        }
        // if(objGroup.children[(value-9)%(objGroup.children.length-5)]){
        //     $('.tags_1').css({'left':toScreenPosition(objGroup.children[(value-9)%(objGroup.children.length-5)].children[0], camera).x+'px'})
        //     $('.tags_1').css({'top' :toScreenPosition(objGroup.children[(value-9)%(objGroup.children.length-5)].children[0], camera).y+'px'})
        //     $('.tags_1').find('.name').html(objGroup.children[(value-9)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1])
        // }
        // if(objGroup.children[(value-8)%(objGroup.children.length-5)]){
        //     $('.tags_2').css({'left':toScreenPosition(objGroup.children[(value-8)%(objGroup.children.length-5)].children[0], camera).x+'px'})
        //     $('.tags_2').css({'top' :toScreenPosition(objGroup.children[(value-8)%(objGroup.children.length-5)].children[0], camera).y+'px'})
        //     $('.tags_2').find('.name').html(objGroup.children[(value-8)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1])
        // }
        // if(objGroup.children[(value-7)%(objGroup.children.length-5)]){
        //     $('.tags_3').css({'left':toScreenPosition(objGroup.children[(value-7)%(objGroup.children.length-5)].children[0], camera).x+'px'})
        //     $('.tags_3').css({'top' :toScreenPosition(objGroup.children[(value-7)%(objGroup.children.length-5)].children[0], camera).y+'px'})
        //     $('.tags_3').find('.name').html(objGroup.children[(value-7)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1])
        // }
        // if(objGroup.children[(value-6)%(objGroup.children.length-5)]){
        //     $('.tags_4').css({'left':toScreenPosition(objGroup.children[(value-6)%(objGroup.children.length-5)].children[0], camera).x+'px'})
        //     $('.tags_4').css({'top' :toScreenPosition(objGroup.children[(value-6)%(objGroup.children.length-5)].children[0], camera).y+'px'})
        //     $('.tags_4').find('.name').html(objGroup.children[(value-6)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1])
        // }
        // if(objGroup.children[(value-5)%(objGroup.children.length-5)]){
        //     $('.tags_5').css({'left':toScreenPosition(objGroup.children[(value-5)%(objGroup.children.length-5)].children[0], camera).x+'px'})
        //     $('.tags_5').css({'top' :toScreenPosition(objGroup.children[(value-5)%(objGroup.children.length-5)].children[0], camera).y+'px'})
        //     $('.tags_5').find('.name').html(objGroup.children[(value-5)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1])
        // }
        if(objGroup.children[(value-4)%(objGroup.children.length-5)]){
            if(objGroup.children[(value-4)%(objGroup.children.length-5)].children[0]){
                        $('.tags_6').css({'left':toScreenPosition(objGroup.children[(value-4)%(objGroup.children.length-5)].children[0], camera).x+'px'})
                        $('.tags_6').css({'top' :toScreenPosition(objGroup.children[(value-4)%(objGroup.children.length-5)].children[0], camera).y+'px'})
                        $('.tags_6').find('.name').html(objGroup.children[(value-4)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1].replace(/%/g, ' '));
                    }}
        if(objGroup.children[(value-3)%(objGroup.children.length-5)]){
            if(objGroup.children[(value-3)%(objGroup.children.length-5)].children[0]){
                        $('.tags_7').css({'left':toScreenPosition(objGroup.children[(value-3)%(objGroup.children.length-5)].children[0], camera).x+'px'})
                        $('.tags_7').css({'top' :toScreenPosition(objGroup.children[(value-3)%(objGroup.children.length-5)].children[0], camera).y+'px'})
                        $('.tags_7').find('.name').html(objGroup.children[(value-3)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1].replace(/%/g, ' '));
                    }}
        if(objGroup.children[(value-2)%(objGroup.children.length-5)]){
            if(objGroup.children[(value-2)%(objGroup.children.length-5)].children[0]){
                        $('.tags_8').css({'left':toScreenPosition(objGroup.children[(value-2)%(objGroup.children.length-5)].children[0], camera).x+'px'})
                        $('.tags_8').css({'top' :toScreenPosition(objGroup.children[(value-2)%(objGroup.children.length-5)].children[0], camera).y+'px'})
                        $('.tags_8').find('.name').html(objGroup.children[(value-2)%(objGroup.children.length-5)].children[0].children[0].name.split('_')[1].replace(/%/g, ' '));
                    }}
        camera.up.set(0, -1, 0);
        camera.position.set(0,0,-5750)
        camera.lookAt(0, 0, 0);
        if(clicked){
            if(ani_counter>1000){
                        click_ani_counter++
                        if(x1 === undefined){
                            x2 = camera.getWorldPosition(worldPosition).x
                            y2 = camera.getWorldPosition(worldPosition).y
                            z2 = camera.getWorldPosition(worldPosition).z
                            selected = intersects[0].object
                            x1 = selected.getWorldPosition(worldPosition).x
                            y1 = selected.getWorldPosition(worldPosition).y
                            z1 = selected.getWorldPosition(worldPosition).z
                        }
            
                        if(click_ani_counter>95){
                            $('.black').show()
                        }
                        if(click_ani_counter<100){
            
                            const x = easeInOutQuad(click_ani_counter/100, x2, x1 - x2, 1);
                            const y = easeInOutQuad(click_ani_counter/100, y2, y1 - y2, 1);
                            const z = easeInOutQuad(click_ani_counter/100, z2, z1 - z2, 1);
                            camera.position.set(x,y,z)
                            console.log(z)
                        }else{
                            window.location.replace("pano.html#"+selected.name);
                        }
                    }
        }else{

        }
    } else {
    }

    renderer.setViewport(left, bottom, width, height);
    renderer.setScissor(left, bottom, width, height);
    renderer.setScissorTest(true);
    renderer.setClearColor( 0x000000, 0 ); // the default

    camera.aspect = width / height;
    camera.updateProjectionMatrix();

    renderer.render(scene, camera);
    }

  requestAnimationFrame(animate);
}

function ease(t) {
  return t<.5 ? 2*t*t : -1+(4-2*t)*t;
}
function easeInOutQuad(t, b, c, d) {
  t /= d / 2;
  if (t < 1) return c / 2 * t * t + b;
  t--;
  return -c / 2 * (t * (t - 2) - 1) + b;
}
    animate();
function degToRad(degrees) {
  return degrees * Math.PI / 180;
}
</script>
<div class="subtitle">
    <span class="subtitle_1">Hi I'm an AI curator</span>
    <span class="subtitle_2">Here, there will be some introduction text.</span>
    <span class="subtitle_3 stop_btn">STOP</span>
</div>
<div class="zoomout"></div>
<div class="tags_wrapper">
    <div class="tags tags_0"><div class="name">tags_0</div><div class="circle"></div></div>
    <div class="tags tags_1"><div class="name">tags_1</div><div class="circle"></div></div>
    <div class="tags tags_2"><div class="name">tags_2</div><div class="circle"></div></div>
    <div class="tags tags_3"><div class="name">tags_3</div><div class="circle"></div></div>
    <div class="tags tags_4"><div class="name">tags_4</div><div class="circle"></div></div>
    <div class="tags tags_5"><div class="name">tags_5</div><div class="circle"></div></div>
    <div class="tags tags_6"><div class="name">tags_6</div><div class="circle"></div></div>
    <div class="tags tags_7"><div class="name">tags_7</div><div class="circle"></div></div>
    <div class="tags tags_8"><div class="name">tags_8</div><div class="circle"></div></div>
</div>
<div class="tags_mouse_wrapper">
    <div class="tags tags_mouse"><div class="name">tags_8</div><div class="circle"></div></div>
</div>
<div class="black"></div>

</body>
</html>
